<?xml version="1.0" encoding="UTF-8"?>
<databaseChangeLog
        xmlns="http://www.liquibase.org/xml/ns/dbchangelog"
        xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
        xmlns:ext="http://www.liquibase.org/xml/ns/dbchangelog-ext"
        xmlns:pro="http://www.liquibase.org/xml/ns/pro"
        xsi:schemaLocation="http://www.liquibase.org/xml/ns/dbchangelog
        http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-latest.xsd
        http://www.liquibase.org/xml/ns/dbchangelog-ext http://www.liquibase.org/xml/ns/dbchangelog/dbchangelog-ext.xsd
        http://www.liquibase.org/xml/ns/pro http://www.liquibase.org/xml/ns/pro/liquibase-pro-latest.xsd"
        logicalFilePath="../db/changelog/data/bands/metallica.xml">

    <changeSet id="band_metallica" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM band AS b WHERE b.name = "Metallica"</sqlCheck>
        </preConditions>
        <insert tableName="band">
            <column name="name" value="Metallica"/>
            <column name="creation" valueDate="1981-10-28"/>
            <column name="logo" valueBlobFile="../images/MetallicaLogo.svg"/>
        </insert>
        <rollback>DELETE FROM band AS b WHERE b.name = "Metallica"</rollback>
    </changeSet>

    <!-- Albums -->
    <changeSet id="metallica_kill_them_all" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Kill 'Em All"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Kill 'Em All"/>
            <column name="release_date" valueDate="1983-07-25"/>
            <column name="cover" valueBlobFile="../images/MetallicaKillEmAllCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Kill 'Em All"</rollback>
    </changeSet>

    <changeSet id="metallica_ride_the_lightning" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Ride the Lightning"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Ride the Lightning"/>
            <column name="release_date" valueDate="1984-07-27"/>
            <column name="cover" valueBlobFile="../images/MetallicaRideTheLightningCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Ride the Lightning"</rollback>
    </changeSet>

    <changeSet id="metallica_master_of_puppets" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Master of Puppets"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Master of Puppets"/>
            <column name="release_date" valueDate="1986-03-03"/>
            <column name="cover" valueBlobFile="../images/MetallicaMasterOfPuppetsCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Master of Puppets"</rollback>
    </changeSet>

    <changeSet id="metallica_and_justice_for_all" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "...And Justice for All"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="...And Justice for All"/>
            <column name="release_date" valueDate="1988-08-25"/>
            <column name="cover" valueBlobFile="../images/MetallicaAndJusticeForAllCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "...And Justice for All"</rollback>
    </changeSet>

    <changeSet id="metallica_metallica" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = ""</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Metallica"/>
            <column name="release_date" valueDate="1991-08-12"/>
            <column name="cover" valueBlobFile="../images/MetallicaBlackAlbumCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Metallica"</rollback>
    </changeSet>

    <changeSet id="metallica_load" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Load"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Load"/>
            <column name="release_date" valueDate="1996-06-04"/>
            <column name="cover" valueBlobFile="../images/MetallicaLoadCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Load"</rollback>
    </changeSet>

    <changeSet id="metallica_reload" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Reload"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Reload"/>
            <column name="release_date" valueDate="1997-11-18"/>
            <column name="cover" valueBlobFile="../images/MetallicaReloadCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Reload"</rollback>
    </changeSet>

    <changeSet id="metallica_stanger" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "St. Anger"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="St. Anger"/>
            <column name="release_date" valueDate="2003-06-05"/>
            <column name="cover" valueBlobFile="../images/MetallicaStAngerCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "St. Anger"</rollback>
    </changeSet>

    <changeSet id="metallica_death_magnetic" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Death Magnetic"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Death Magnetic"/>
            <column name="release_date" valueDate="2008-09-12"/>
            <column name="cover" valueBlobFile="../images/MetallicaDeathMagneticCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Death Magnetic"</rollback>
    </changeSet>

    <changeSet id="metallica_hardwired_to_selfdestruct" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "Hardwired... to Self-Destruct"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="Hardwired... to Self-Destruct"/>
            <column name="release_date" valueDate="2016-11-18"/>
            <column name="cover" valueBlobFile="../images/MetallicaHardwiredToSelfDestructCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "Hardwired... to Self-Destruct"</rollback>
    </changeSet>

    <changeSet id="metallica_72_seasons" author="${author}">
        <preConditions onFail="MARK_RAN">
            <sqlCheck expectedResult="0">SELECT COUNT(1) FROM album AS a WHERE a.name = "72 Seasons"</sqlCheck>
        </preConditions>
        <insert tableName="album">
            <column name="band_id" valueComputed="(SELECT b.id FROM band AS b WHERE b.name = 'Metallica')"/>
            <column name="name" value="72 Seasons"/>
            <column name="release_date" valueDate="2023-04-14"/>
            <column name="cover" valueBlobFile="../images/Metallica72SeasonsCover.webp"/>
        </insert>
        <rollback>DELETE FROM album AS a WHERE a.name = "72 Seasons"</rollback>
    </changeSet>

</databaseChangeLog>